<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>iceberg-cpp: iceberg::RollingManifestWriter Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">iceberg-cpp
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>iceberg</b></li><li class="navelem"><a class="el" href="classiceberg_1_1RollingManifestWriter.html">RollingManifestWriter</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classiceberg_1_1RollingManifestWriter-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">iceberg::RollingManifestWriter Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>A rolling manifest writer that can produce multiple manifest files.  
 <a href="classiceberg_1_1RollingManifestWriter.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="rolling__manifest__writer_8h_source.html">rolling_manifest_writer.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a5fab08a0de87cca6daede640edf8e331" id="r_a5fab08a0de87cca6daede640edf8e331"><td class="memItemLeft" align="right" valign="top"><a id="a5fab08a0de87cca6daede640edf8e331" name="a5fab08a0de87cca6daede640edf8e331"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><b>ManifestWriterFactory</b> = std::function&lt; Result&lt; std::unique_ptr&lt; <a class="el" href="classiceberg_1_1ManifestWriter.html">ManifestWriter</a> &gt; &gt;()&gt;</td></tr>
<tr class="memdesc:a5fab08a0de87cca6daede640edf8e331"><td class="mdescLeft">&#160;</td><td class="mdescRight">Factory function type for creating <a class="el" href="classiceberg_1_1ManifestWriter.html" title="Write manifest entries to a manifest file.">ManifestWriter</a> instances. <br /></td></tr>
<tr class="separator:a5fab08a0de87cca6daede640edf8e331"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa2a0c6404dec184d7f760fb206ef687d" id="r_aa2a0c6404dec184d7f760fb206ef687d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classiceberg_1_1RollingManifestWriter.html#aa2a0c6404dec184d7f760fb206ef687d">RollingManifestWriter</a> (<a class="el" href="classiceberg_1_1RollingManifestWriter.html#a5fab08a0de87cca6daede640edf8e331">ManifestWriterFactory</a> manifest_writer_factory, int64_t target_file_size_in_bytes)</td></tr>
<tr class="memdesc:aa2a0c6404dec184d7f760fb206ef687d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a rolling manifest writer.  <br /></td></tr>
<tr class="separator:aa2a0c6404dec184d7f760fb206ef687d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa32ff509341ef27d59e7fb311fe80b87" id="r_aa32ff509341ef27d59e7fb311fe80b87"><td class="memItemLeft" align="right" valign="top">Status&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classiceberg_1_1RollingManifestWriter.html#aa32ff509341ef27d59e7fb311fe80b87">WriteAddedEntry</a> (std::shared_ptr&lt; <a class="el" href="structiceberg_1_1DataFile.html">DataFile</a> &gt; file, std::optional&lt; int64_t &gt; data_sequence_number=std::nullopt)</td></tr>
<tr class="memdesc:aa32ff509341ef27d59e7fb311fe80b87"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add an added entry for a file.  <br /></td></tr>
<tr class="separator:aa32ff509341ef27d59e7fb311fe80b87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6dab671d56518a03c4407b2e7ba4c417" id="r_a6dab671d56518a03c4407b2e7ba4c417"><td class="memItemLeft" align="right" valign="top">Status&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classiceberg_1_1RollingManifestWriter.html#a6dab671d56518a03c4407b2e7ba4c417">WriteExistingEntry</a> (std::shared_ptr&lt; <a class="el" href="structiceberg_1_1DataFile.html">DataFile</a> &gt; file, int64_t file_snapshot_id, int64_t data_sequence_number, std::optional&lt; int64_t &gt; file_sequence_number=std::nullopt)</td></tr>
<tr class="memdesc:a6dab671d56518a03c4407b2e7ba4c417"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add an existing entry for a file.  <br /></td></tr>
<tr class="separator:a6dab671d56518a03c4407b2e7ba4c417"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13239912ef1e674e34a2ac57dc3663ad" id="r_a13239912ef1e674e34a2ac57dc3663ad"><td class="memItemLeft" align="right" valign="top">Status&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classiceberg_1_1RollingManifestWriter.html#a13239912ef1e674e34a2ac57dc3663ad">WriteDeletedEntry</a> (std::shared_ptr&lt; <a class="el" href="structiceberg_1_1DataFile.html">DataFile</a> &gt; file, int64_t data_sequence_number, std::optional&lt; int64_t &gt; file_sequence_number=std::nullopt)</td></tr>
<tr class="memdesc:a13239912ef1e674e34a2ac57dc3663ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a delete entry for a file.  <br /></td></tr>
<tr class="separator:a13239912ef1e674e34a2ac57dc3663ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addcb9a2f02554bf4d3db12315cac7f19" id="r_addcb9a2f02554bf4d3db12315cac7f19"><td class="memItemLeft" align="right" valign="top"><a id="addcb9a2f02554bf4d3db12315cac7f19" name="addcb9a2f02554bf4d3db12315cac7f19"></a>
Status&#160;</td><td class="memItemRight" valign="bottom"><b>Close</b> ()</td></tr>
<tr class="memdesc:addcb9a2f02554bf4d3db12315cac7f19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close the rolling manifest writer. <br /></td></tr>
<tr class="separator:addcb9a2f02554bf4d3db12315cac7f19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bfd6ab601bdbef9cc8b0c8079243f91" id="r_a8bfd6ab601bdbef9cc8b0c8079243f91"><td class="memItemLeft" align="right" valign="top">Result&lt; std::vector&lt; <a class="el" href="structiceberg_1_1ManifestFile.html">ManifestFile</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classiceberg_1_1RollingManifestWriter.html#a8bfd6ab601bdbef9cc8b0c8079243f91">ToManifestFiles</a> () const</td></tr>
<tr class="memdesc:a8bfd6ab601bdbef9cc8b0c8079243f91"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the list of manifest files produced by this writer.  <br /></td></tr>
<tr class="separator:a8bfd6ab601bdbef9cc8b0c8079243f91"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A rolling manifest writer that can produce multiple manifest files. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aa2a0c6404dec184d7f760fb206ef687d" name="aa2a0c6404dec184d7f760fb206ef687d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2a0c6404dec184d7f760fb206ef687d">&#9670;&#160;</a></span>RollingManifestWriter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">iceberg::RollingManifestWriter::RollingManifestWriter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classiceberg_1_1RollingManifestWriter.html#a5fab08a0de87cca6daede640edf8e331">ManifestWriterFactory</a>&#160;</td>
          <td class="paramname"><em>manifest_writer_factory</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>target_file_size_in_bytes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct a rolling manifest writer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">manifest_writer_factory</td><td>Factory function to create new <a class="el" href="classiceberg_1_1ManifestWriter.html" title="Write manifest entries to a manifest file.">ManifestWriter</a> instances. </td></tr>
    <tr><td class="paramname">target_file_size_in_bytes</td><td>Target file size in bytes. When the current file reaches this size (and row count is a multiple of 250), a new file will be created. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a8bfd6ab601bdbef9cc8b0c8079243f91" name="a8bfd6ab601bdbef9cc8b0c8079243f91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bfd6ab601bdbef9cc8b0c8079243f91">&#9670;&#160;</a></span>ToManifestFiles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Result&lt; std::vector&lt; <a class="el" href="structiceberg_1_1ManifestFile.html">ManifestFile</a> &gt; &gt; iceberg::RollingManifestWriter::ToManifestFiles </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the list of manifest files produced by this writer. </p>
<dl class="section return"><dt>Returns</dt><dd>A vector of <a class="el" href="structiceberg_1_1ManifestFile.html" title="Entry in a manifest list.">ManifestFile</a> objects </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Only valid after the writer is closed. </dd></dl>

</div>
</div>
<a id="aa32ff509341ef27d59e7fb311fe80b87" name="aa32ff509341ef27d59e7fb311fe80b87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa32ff509341ef27d59e7fb311fe80b87">&#9670;&#160;</a></span>WriteAddedEntry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Status iceberg::RollingManifestWriter::WriteAddedEntry </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="structiceberg_1_1DataFile.html">DataFile</a> &gt;&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::optional&lt; int64_t &gt;&#160;</td>
          <td class="paramname"><em>data_sequence_number</em> = <code>std::nullopt</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add an added entry for a file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>a data file </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Status indicating success or failure </dd></dl>
<dl class="section note"><dt>Note</dt><dd>The entry's snapshot ID will be this manifest's snapshot ID. The entry's data sequence number will be the provided data sequence number. The entry's file sequence number will be assigned at commit. </dd></dl>

</div>
</div>
<a id="a13239912ef1e674e34a2ac57dc3663ad" name="a13239912ef1e674e34a2ac57dc3663ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13239912ef1e674e34a2ac57dc3663ad">&#9670;&#160;</a></span>WriteDeletedEntry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Status iceberg::RollingManifestWriter::WriteDeletedEntry </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="structiceberg_1_1DataFile.html">DataFile</a> &gt;&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>data_sequence_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::optional&lt; int64_t &gt;&#160;</td>
          <td class="paramname"><em>file_sequence_number</em> = <code>std::nullopt</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a delete entry for a file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>a deleted data file </td></tr>
    <tr><td class="paramname">data_sequence_number</td><td>a data sequence number of the file (assigned when the file was added) </td></tr>
    <tr><td class="paramname">file_sequence_number</td><td>a file sequence number (assigned when the file was added) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Status indicating success or failure </dd></dl>
<dl class="section note"><dt>Note</dt><dd>The entry's snapshot ID will be this manifest's snapshot ID. However, the original data and file sequence numbers of the file must be preserved when the file is marked as deleted. </dd></dl>

</div>
</div>
<a id="a6dab671d56518a03c4407b2e7ba4c417" name="a6dab671d56518a03c4407b2e7ba4c417"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6dab671d56518a03c4407b2e7ba4c417">&#9670;&#160;</a></span>WriteExistingEntry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Status iceberg::RollingManifestWriter::WriteExistingEntry </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="structiceberg_1_1DataFile.html">DataFile</a> &gt;&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>file_snapshot_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>data_sequence_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::optional&lt; int64_t &gt;&#160;</td>
          <td class="paramname"><em>file_sequence_number</em> = <code>std::nullopt</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add an existing entry for a file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>an existing data file </td></tr>
    <tr><td class="paramname">file_snapshot_id</td><td>snapshot ID when the data file was added to the table </td></tr>
    <tr><td class="paramname">data_sequence_number</td><td>a data sequence number of the file (assigned when the file was added) </td></tr>
    <tr><td class="paramname">file_sequence_number</td><td>a file sequence number (assigned when the file was added) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Status indicating success or failure </dd></dl>
<dl class="section note"><dt>Note</dt><dd>The original data and file sequence numbers, snapshot ID, which were assigned at commit, must be preserved when adding an existing entry. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>iceberg/manifest/<a class="el" href="rolling__manifest__writer_8h_source.html">rolling_manifest_writer.h</a></li>
<li>iceberg/manifest/<b>rolling_manifest_writer.cc</b></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
